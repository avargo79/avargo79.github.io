import{a as g}from"./chunk-EC5LA6IH.js";import{a as m,aa as h,b as p,c as u,da as D,ea as f,ua as c}from"./chunk-IQ6ZNRPZ.js";var E=class d{wallet=c({credits:1e3,bitcoin:0});transactions=c([]);nextTransactionId=1;totalEarned=c(0);totalSpent=c(0);passiveIncomeRate=c(0);lastPassiveIncomeTime=c(Date.now());lastMaintenanceTime=c(Date.now());lastActivityTime=c(Date.now());passiveIncomeInterval;maintenanceInterval;gameDifficulty=c("normal");sandboxMode=!1;constructor(){this.loadWallet(),this.loadTransactions(),this.loadTotals(),this.loadPassiveIncome(),this.loadGameDifficulty(),this.startPassiveIncome(),this.startMaintenance()}get wallet$(){return this.wallet.asReadonly()}get transactions$(){return this.transactions.asReadonly()}getBalance(e="credits"){return e==="credits"?this.wallet().credits:this.wallet().bitcoin||0}getTotalEarned(){return this.totalEarned()}getTotalSpent(){return this.totalSpent()}getNetWorth(){return this.wallet().credits+(this.wallet().bitcoin||0)*1e3}getTransactionHistory(e){let t=this.transactions();return e?t.slice(0,e):t}getTransactionsByType(e){return this.transactions().filter(t=>t.type===e)}addCredits(e,t,i,s){if(e<=0)throw new Error("Amount must be positive");let r=this.createTransaction(e,t,i,s);return this.wallet.update(o=>p(m({},o),{credits:o.credits+e})),this.totalEarned.update(o=>o+e),this.addTransaction(r),this.saveWallet(),this.saveTotals(),r}deductCredits(e,t,i,s){if(e<=0)return{success:!1,error:"Amount must be positive"};if(this.wallet().credits<e)return{success:!1,error:"Insufficient funds",remainingBalance:this.wallet().credits};let r=this.createTransaction(-e,t,i,s);return this.wallet.update(o=>p(m({},o),{credits:o.credits-e})),this.totalSpent.update(o=>o+e),this.addTransaction(r),this.saveWallet(),this.saveTotals(),{success:!0,transaction:r,remainingBalance:this.wallet().credits}}purchase(e,t,i){return this.deductCredits(e,"purchase",`Purchased ${t}`,i)}sell(e,t,i){return this.addCredits(e,"sale",`Sold ${t}`,i)}addPassiveIncome(e,t,i){return this.addCredits(e,"passive_income",`Passive income from ${t}`,i)}applyPenalty(e,t,i){return this.deductCredits(e,"penalty",`Penalty: ${t}`,i)}refund(e,t,i){return this.addCredits(e,"refund",`Refund: ${t}`,i)}canAfford(e,t="credits"){return this.getBalance(t)>=e}getWalletSnapshot(){return{balance:this.wallet().credits,timestamp:Date.now(),totalEarned:this.totalEarned(),totalSpent:this.totalSpent()}}clearTransactionHistory(){this.transactions.set([]),this.saveTransactions()}resetWallet(e=1e3){this.wallet.set({credits:e,bitcoin:0}),this.totalEarned.set(0),this.totalSpent.set(0),this.transactions.set([]),this.nextTransactionId=1,this.passiveIncomeRate.set(0),this.lastPassiveIncomeTime.set(Date.now()),this.lastMaintenanceTime.set(Date.now()),this.lastActivityTime.set(Date.now()),this.saveWallet(),this.saveTotals(),this.saveTransactions(),this.savePassiveIncome()}getPassiveIncomeRate(){return this.passiveIncomeRate()}setPassiveIncomeRate(e){this.passiveIncomeRate.set(e),this.savePassiveIncome()}updateActivity(){this.lastActivityTime.set(Date.now())}getGameDifficulty(){return this.gameDifficulty()}setGameDifficulty(e){this.gameDifficulty.set(e),this.saveGameDifficulty()}getDifficultyMultiplier(){switch(this.gameDifficulty()){case"easy":return .5;case"hard":return 1.5;default:return 1}}startPassiveIncome(){typeof window>"u"||(this.passiveIncomeInterval=window.setInterval(()=>{let e=this.passiveIncomeRate();if(e<=0)return;let t=Date.now(),i=this.lastPassiveIncomeTime(),s=(t-i)/1e3;if(s>=1){let r=Math.floor(e*s);r>0&&(this.addPassiveIncome(r,"passive income generators"),this.lastPassiveIncomeTime.set(t),this.savePassiveIncome())}},1e3))}startMaintenance(){typeof window>"u"||(this.maintenanceInterval=window.setInterval(()=>{let e=this.passiveIncomeRate();if(e<=0)return;let t=Date.now(),i=this.lastMaintenanceTime();if((t-i)/6e4>=10){let r=this.lastActivityTime(),o=(t-r)/6e4,n=.3;o>240?n=.75:o>60&&(n=.5);let a=e*600,l=Math.floor(a*n);l>0&&(this.deductCredits(l,"maintenance","Maintenance: Passive income upkeep",{maintenanceRate:n,idleTime:Math.floor(o*60)}),this.lastMaintenanceTime.set(t))}},6e4))}savePassiveIncome(){if(!this.sandboxMode)try{localStorage.setItem("webos_passive_income",JSON.stringify({rate:this.passiveIncomeRate(),lastTime:this.lastPassiveIncomeTime(),lastMaintenance:this.lastMaintenanceTime(),lastActivity:this.lastActivityTime()}))}catch(e){console.error("Failed to save passive income:",e)}}loadPassiveIncome(){try{let e=localStorage.getItem("webos_passive_income");if(e){let t=JSON.parse(e);this.passiveIncomeRate.set(t.rate||0),this.lastPassiveIncomeTime.set(t.lastTime||Date.now()),this.lastMaintenanceTime.set(t.lastMaintenance||Date.now()),this.lastActivityTime.set(t.lastActivity||Date.now());let i=Date.now(),s=(i-this.lastPassiveIncomeTime())/1e3,r=this.passiveIncomeRate();if(r>0&&s>0){let o=Math.floor(r*s);o>0&&this.addPassiveIncome(o,"passive income (offline)"),this.lastPassiveIncomeTime.set(i),this.savePassiveIncome()}}}catch(e){console.error("Failed to load passive income:",e)}}createTransaction(e,t,i,s){return{id:`tx_${this.nextTransactionId++}`,type:t,amount:e,description:i,timestamp:Date.now(),metadata:s}}addTransaction(e){this.transactions.update(t=>[e,...t]),this.saveTransactions()}saveWallet(){if(!this.sandboxMode)try{localStorage.setItem("webos_wallet",JSON.stringify(this.wallet()))}catch(e){console.error("Failed to save wallet:",e)}}loadWallet(){try{let e=localStorage.getItem("webos_wallet");if(e){let t=JSON.parse(e);this.wallet.set(t)}}catch(e){console.error("Failed to load wallet:",e)}}saveTransactions(){if(!this.sandboxMode)try{let e=this.transactions().slice(0,500);if(localStorage.setItem("webos_transactions",JSON.stringify(e)),e.length>0){let t=Math.max(...e.map(i=>parseInt(i.id.split("_")[1])||0));this.nextTransactionId=t+1}}catch(e){console.error("Failed to save transactions:",e)}}loadTransactions(){try{let e=localStorage.getItem("webos_transactions");if(e){let t=JSON.parse(e);if(this.transactions.set(t),t.length>0){let i=Math.max(...t.map(s=>parseInt(s.id.split("_")[1])||0));this.nextTransactionId=i+1}}}catch(e){console.error("Failed to load transactions:",e)}}saveTotals(){if(!this.sandboxMode)try{localStorage.setItem("webos_economy_totals",JSON.stringify({totalEarned:this.totalEarned(),totalSpent:this.totalSpent()}))}catch(e){console.error("Failed to save totals:",e)}}loadTotals(){try{let e=localStorage.getItem("webos_economy_totals");if(e){let t=JSON.parse(e);this.totalEarned.set(t.totalEarned||0),this.totalSpent.set(t.totalSpent||0)}}catch(e){console.error("Failed to load totals:",e)}}saveGameDifficulty(){try{localStorage.setItem("webos_game_difficulty",this.gameDifficulty())}catch(e){console.error("Failed to save game difficulty:",e)}}loadGameDifficulty(){try{let e=localStorage.getItem("webos_game_difficulty");e&&(e==="easy"||e==="normal"||e==="hard")&&this.gameDifficulty.set(e)}catch(e){console.error("Failed to load game difficulty:",e)}}setSandboxMode(e){this.sandboxMode=e}createSandboxSnapshot(){let e=this.wallet();return{wallet:{credits:e.credits,bitcoin:e.bitcoin??0},transactions:[...this.transactions()],totalEarned:this.totalEarned(),totalSpent:this.totalSpent(),passiveIncomeRate:this.passiveIncomeRate()}}restoreSandboxSnapshot(e){this.wallet.set(m({},e.wallet)),this.transactions.set([...e.transactions]),this.totalEarned.set(e.totalEarned),this.totalSpent.set(e.totalSpent),this.passiveIncomeRate.set(e.passiveIncomeRate),this.saveWallet(),this.saveTransactions(),this.saveTotals(),this.savePassiveIncome()}static \u0275fac=function(t){return new(t||d)};static \u0275prov=h({token:d,factory:d.\u0275fac,providedIn:"root"})};var w=class d{audioContext=null;sfxCache=new Map;ambientPlayer=null;masterVolume=c(.5);sfxVolume=c(.7);musicVolume=c(.6);muted=c(!1);currentTrack=c("none");constructor(){typeof window<"u"&&"AudioContext"in window&&(this.audioContext=new AudioContext,this.ambientPlayer=new Audio,this.ambientPlayer.loop=!0)}setMasterVolume(e){this.masterVolume.set(Math.max(0,Math.min(1,e)))}setSfxVolume(e){this.sfxVolume.set(Math.max(0,Math.min(1,e)))}setMusicVolume(e){this.musicVolume.set(Math.max(0,Math.min(1,e))),this.ambientPlayer&&(this.ambientPlayer.volume=this.getEffectiveMusicVolume())}toggleMute(){this.muted.update(e=>!e),this.ambientPlayer&&(this.ambientPlayer.muted=this.muted())}setMuted(e){this.muted.set(e),this.ambientPlayer&&(this.ambientPlayer.muted=e)}getEffectiveSfxVolume(){return this.muted()?0:this.masterVolume()*this.sfxVolume()}getEffectiveMusicVolume(){return this.muted()?0:this.masterVolume()*this.musicVolume()}playSfx(e){if(!this.audioContext||this.muted())return;let t=this.getSfxFrequency(e),i=this.getSfxDuration(e),s=this.getEffectiveSfxVolume();try{let r=this.audioContext.createOscillator(),o=this.audioContext.createGain();r.connect(o),o.connect(this.audioContext.destination),r.frequency.value=t,r.type=this.getSfxWaveform(e),o.gain.setValueAtTime(s*.3,this.audioContext.currentTime),o.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+i),r.start(this.audioContext.currentTime),r.stop(this.audioContext.currentTime+i)}catch(r){console.warn("Failed to play sound effect:",r)}}getSfxFrequency(e){return{keypress:800,command_success:600,command_error:200,notification:880,window_open:440,window_close:330,button_click:1e3,hack_success:660,hack_fail:180,transfer_complete:523,achievement_unlock:784,alarm_triggered:1200,detection_warning:950}[e]}getSfxDuration(e){return{keypress:.05,command_success:.15,command_error:.2,notification:.25,window_open:.1,window_close:.1,button_click:.05,hack_success:.3,hack_fail:.3,transfer_complete:.4,achievement_unlock:.5,alarm_triggered:.6,detection_warning:.3}[e]}getSfxWaveform(e){return{keypress:"sine",command_success:"sine",command_error:"sawtooth",notification:"sine",window_open:"triangle",window_close:"triangle",button_click:"sine",hack_success:"square",hack_fail:"sawtooth",transfer_complete:"sine",achievement_unlock:"sine",alarm_triggered:"square",detection_warning:"triangle"}[e]}playAmbient(e){if(this.ambientPlayer){if(this.currentTrack.set(e),e==="none"){this.ambientPlayer.pause(),this.ambientPlayer.src="";return}this.ambientPlayer.volume=this.getEffectiveMusicVolume(),this.ambientPlayer.muted=this.muted(),this.ambientPlayer.play().catch(t=>{console.warn("Failed to play ambient track:",t)})}}stopAmbient(){this.playAmbient("none")}pauseAmbient(){this.ambientPlayer&&this.ambientPlayer.pause()}resumeAmbient(){this.ambientPlayer&&this.currentTrack()!=="none"&&this.ambientPlayer.play().catch(e=>{console.warn("Failed to resume ambient track:",e)})}static \u0275fac=function(t){return new(t||d)};static \u0275prov=h({token:d,factory:d.\u0275fac,providedIn:"root"})};var A=(r=>(r.AVAILABLE="available",r.ACTIVE="active",r.COMPLETED="completed",r.FAILED="failed",r.EXPIRED="expired",r))(A||{}),L=(s=>(s.EASY="easy",s.MEDIUM="medium",s.HARD="hard",s.EXPERT="expert",s))(L||{}),k=(l=>(l.HACK_SERVER="hack_server",l.STEAL_FILE="steal_file",l.UPLOAD_FILE="upload_file",l.DELETE_FILE="delete_file",l.SCAN_NETWORK="scan_network",l.CRACK_PASSWORD="crack_password",l.INSTALL_BACKDOOR="install_backdoor",l.CLEAR_LOGS="clear_logs",l.TRANSFER_FUNDS="transfer_funds",l))(k||{});var O=(i=>(i.NONE="none",i.USER="user",i.ROOT="root",i))(O||{});var M=class d{notificationService=f(g);audioService=f(w);state={hosts:{},connections:[],currentHost:"127.0.0.1",scanHistory:[],exploitHistory:[],playerIp:"127.0.0.1",detectionLevel:0,alarmTriggered:!1};stateSignal=c(this.state);decayTimer;DECAY_INTERVAL=6e4;DECAY_AMOUNT=5;warningThresholdsTriggered=new Set;sandboxMode=!1;constructor(){this.initializeNetwork(),this.updateSignal(),this.startDecayTimer()}updateSignal(){this.stateSignal.set(m({},this.state))}get state$(){return this.stateSignal.asReadonly()}initializeNetwork(){let e={id:"player",ip:"127.0.0.1",hostname:"localhost",type:"player",ports:[{number:22,status:"open",service:"ssh"}],accessLevel:"root",isDiscovered:!0,isOnline:!0,securityLevel:5,coordinates:{x:400,y:300}},t=[{id:"corp-file-server",ip:"192.168.1.10",hostname:"corp-file-01",type:"file-server",ports:[{number:21,status:"open",service:"ftp",vulnerability:{id:"ftp-anon",name:"Anonymous FTP",description:"FTP server allows anonymous login",exploitCommand:"exploit ftp-anon 192.168.1.10",successRate:.9,detectability:.2}},{number:22,status:"closed",service:"ssh"},{number:445,status:"open",service:"smb"}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:3,coordinates:{x:550,y:180},fileSystem:{files:["quarterly-report.pdf","employee-data.xlsx","passwords.db","financial-records.csv"],directories:["logs","documents","backup","shared"]}},{id:"corp-db-01",ip:"192.168.1.20",hostname:"corp-db-01",type:"database",ports:[{number:3306,status:"open",service:"mysql",vulnerability:{id:"sql-injection",name:"SQL Injection",description:"Database vulnerable to SQL injection attacks",exploitCommand:"exploit sql-injection 192.168.1.20",requiredTools:["sqlmap"],successRate:.75,detectability:.4}},{number:22,status:"open",service:"ssh"}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:5,coordinates:{x:600,y:120},fileSystem:{files:["customers.db","transactions.db","accounts.db","backup.sql"],directories:["var/log","data","backup"]}},{id:"corp-mail-01",ip:"192.168.1.30",hostname:"corp-mail-01",type:"mail-server",ports:[{number:25,status:"open",service:"smtp",vulnerability:{id:"smtp-relay",name:"Open SMTP Relay",description:"Mail server configured as open relay",exploitCommand:"exploit smtp-relay 192.168.1.30",successRate:.85,detectability:.3}},{number:110,status:"open",service:"pop3"},{number:143,status:"open",service:"imap"}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:4,coordinates:{x:650,y:160},fileSystem:{files:["inbox.mbox","sent.mbox","confidential-memo.eml","credentials-reset.eml"],directories:["mail","logs","queue"]}},{id:"corp-web-01",ip:"192.168.1.40",hostname:"corp-web-01",type:"web-server",ports:[{number:80,status:"open",service:"http",vulnerability:{id:"webshell-upload",name:"Unrestricted File Upload",description:"Web application allows arbitrary file upload",exploitCommand:"exploit webshell-upload 192.168.1.40",successRate:.7,detectability:.5}},{number:443,status:"open",service:"https"},{number:22,status:"open",service:"ssh"}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:4,coordinates:{x:700,y:200},fileSystem:{files:["index.html","admin.php","config.php","access.log"],directories:["var/www","logs","uploads"]}},{id:"corp-workstation-01",ip:"192.168.1.50",hostname:"dev-workstation",type:"workstation",ports:[{number:22,status:"open",service:"ssh",vulnerability:{id:"ssh-weak",name:"Weak SSH Credentials",description:"SSH server uses weak default credentials",exploitCommand:"exploit ssh-weak 192.168.1.50",requiredTools:["hydra"],successRate:.7,detectability:.5}},{number:3389,status:"open",service:"rdp"}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:2,coordinates:{x:750,y:240},fileSystem:{files:["notes.txt","credentials.txt","source-code.zip"],directories:["documents","downloads","projects"]}},{id:"corp-workstation-02",ip:"192.168.1.51",hostname:"admin-workstation",type:"workstation",ports:[{number:3389,status:"open",service:"rdp",vulnerability:{id:"rdp-bluekeep",name:"BlueKeep RDP Vulnerability",description:"RDP service vulnerable to CVE-2019-0708",exploitCommand:"exploit rdp-bluekeep 192.168.1.51",requiredTools:["metasploit"],successRate:.6,detectability:.7}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:3,coordinates:{x:800,y:180},fileSystem:{files:["admin-keys.txt","vpn-config.ovpn","domain-creds.txt"],directories:["documents","desktop"]}},{id:"dmz-web-01",ip:"172.16.0.10",hostname:"dmz-web-01",type:"web-server",ports:[{number:80,status:"open",service:"http"},{number:443,status:"open",service:"https",vulnerability:{id:"heartbleed",name:"Heartbleed SSL Vulnerability",description:"OpenSSL heartbleed vulnerability",exploitCommand:"exploit heartbleed 172.16.0.10",successRate:.8,detectability:.3}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:3,coordinates:{x:450,y:250},fileSystem:{files:["index.html","api.php","ssl-cert.pem"],directories:["var/www","logs"]}},{id:"dmz-mail-gateway",ip:"172.16.0.20",hostname:"mail-gateway",type:"mail-server",ports:[{number:25,status:"open",service:"smtp",vulnerability:{id:"smtp-enum",name:"SMTP User Enumeration",description:"SMTP server allows user enumeration",exploitCommand:"exploit smtp-enum 172.16.0.20",successRate:.9,detectability:.2}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:2,coordinates:{x:500,y:280},fileSystem:{files:["mail-queue.db","users.txt"],directories:["queue","logs"]}},{id:"dmz-firewall",ip:"172.16.0.1",hostname:"dmz-firewall",type:"firewall",ports:[{number:443,status:"open",service:"https",vulnerability:{id:"firewall-config",name:"Firewall Misconfiguration",description:"Firewall rules allow unauthorized access",exploitCommand:"exploit firewall-config 172.16.0.1",successRate:.5,detectability:.6}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:5,coordinates:{x:400,y:220},fileSystem:{files:["firewall-rules.conf","access-list.txt"],directories:["config","logs"]}},{id:"internal-db-01",ip:"10.0.0.10",hostname:"internal-db-01",type:"database",ports:[{number:5432,status:"open",service:"postgresql",vulnerability:{id:"postgres-weak-auth",name:"Weak PostgreSQL Authentication",description:"PostgreSQL uses weak authentication",exploitCommand:"exploit postgres-weak-auth 10.0.0.10",requiredTools:["hydra"],successRate:.7,detectability:.4}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:6,coordinates:{x:350,y:300},fileSystem:{files:["payroll.db","hr-records.db","backups.tar.gz"],directories:["data","backup","logs"]}},{id:"internal-file-01",ip:"10.0.0.20",hostname:"internal-file-01",type:"file-server",ports:[{number:445,status:"open",service:"smb",vulnerability:{id:"eternalblue",name:"EternalBlue SMB Exploit",description:"SMB vulnerable to MS17-010",exploitCommand:"exploit eternalblue 10.0.0.20",requiredTools:["metasploit"],successRate:.85,detectability:.6}},{number:139,status:"open",service:"netbios"}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:4,coordinates:{x:300,y:350},fileSystem:{files:["research-data.zip","patents.pdf","source-code-backup.tar"],directories:["research","legal","engineering"]}},{id:"internal-backup-01",ip:"10.0.0.30",hostname:"backup-server",type:"file-server",ports:[{number:22,status:"open",service:"ssh",vulnerability:{id:"ssh-key-leak",name:"Leaked SSH Private Key",description:"SSH private key exposed in public repository",exploitCommand:"exploit ssh-key-leak 10.0.0.30",successRate:.95,detectability:.1}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:5,coordinates:{x:350,y:400},fileSystem:{files:["full-backup-2024.tar.gz","incremental-backup.tar","restore.sh"],directories:["backups","scripts","logs"]}},{id:"internal-gateway",ip:"10.0.0.1",hostname:"internal-gateway",type:"router",ports:[{number:23,status:"open",service:"telnet",vulnerability:{id:"telnet-default",name:"Default Telnet Password",description:"Router uses factory default credentials",exploitCommand:"exploit telnet-default 10.0.0.1",successRate:.95,detectability:.3}},{number:80,status:"open",service:"http"}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:3,coordinates:{x:300,y:250},fileSystem:{files:["router-config.conf","dhcp-leases.txt"],directories:["config"]}},{id:"cloud-web-01",ip:"203.0.113.10",hostname:"cloud-web-01",type:"web-server",ports:[{number:80,status:"open",service:"http"},{number:443,status:"open",service:"https",vulnerability:{id:"api-auth-bypass",name:"API Authentication Bypass",description:"REST API allows authentication bypass",exploitCommand:"exploit api-auth-bypass 203.0.113.10",successRate:.65,detectability:.5}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:4,coordinates:{x:250,y:150},fileSystem:{files:["api-keys.json","user-data.json","app.log"],directories:["api","logs","uploads"]}},{id:"cloud-db-01",ip:"203.0.113.20",hostname:"cloud-db-01",type:"database",ports:[{number:27017,status:"open",service:"mongodb",vulnerability:{id:"mongo-noauth",name:"MongoDB No Authentication",description:"MongoDB instance has no authentication enabled",exploitCommand:"exploit mongo-noauth 203.0.113.20",successRate:.95,detectability:.2}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:2,coordinates:{x:200,y:200},fileSystem:{files:["users.bson","sessions.bson","analytics.bson"],directories:["data","logs"]}},{id:"cloud-storage-01",ip:"203.0.113.30",hostname:"cloud-storage-01",type:"file-server",ports:[{number:443,status:"open",service:"https",vulnerability:{id:"s3-public-bucket",name:"Public S3 Bucket",description:"Cloud storage bucket publicly accessible",exploitCommand:"exploit s3-public-bucket 203.0.113.30",successRate:.9,detectability:.15}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:1,coordinates:{x:150,y:250},fileSystem:{files:["customer-uploads.zip","public-assets.tar","private-keys.pem"],directories:["public","private","temp"]}},{id:"cloud-api-gateway",ip:"203.0.113.40",hostname:"api-gateway",type:"web-server",ports:[{number:443,status:"open",service:"https",vulnerability:{id:"jwt-weak-secret",name:"Weak JWT Secret",description:"JWT tokens signed with weak secret key",exploitCommand:"exploit jwt-weak-secret 203.0.113.40",requiredTools:["hashcat"],successRate:.7,detectability:.4}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:4,coordinates:{x:200,y:100},fileSystem:{files:["jwt-secret.key","api-routes.json","rate-limits.conf"],directories:["config","logs"]}},{id:"iot-camera-01",ip:"192.168.2.10",hostname:"security-cam-01",type:"iot-device",ports:[{number:554,status:"open",service:"rtsp",vulnerability:{id:"iot-default-creds",name:"IoT Default Credentials",description:"Device uses factory default credentials",exploitCommand:"exploit iot-default-creds 192.168.2.10",successRate:.95,detectability:.2}},{number:80,status:"open",service:"http"}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:1,coordinates:{x:850,y:300},fileSystem:{files:["video-feed.h264","config.xml"],directories:["recordings","logs"]}},{id:"iot-thermostat",ip:"192.168.2.20",hostname:"hvac-control",type:"iot-device",ports:[{number:80,status:"open",service:"http",vulnerability:{id:"iot-firmware-vuln",name:"Outdated IoT Firmware",description:"Device running vulnerable firmware version",exploitCommand:"exploit iot-firmware-vuln 192.168.2.20",successRate:.8,detectability:.3}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:1,coordinates:{x:900,y:350},fileSystem:{files:["temperature-log.csv","settings.json"],directories:["logs"]}},{id:"iot-door-controller",ip:"192.168.2.30",hostname:"access-control",type:"iot-device",ports:[{number:443,status:"open",service:"https",vulnerability:{id:"iot-command-injection",name:"Command Injection",description:"Web interface vulnerable to command injection",exploitCommand:"exploit iot-command-injection 192.168.2.30",successRate:.75,detectability:.4}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:2,coordinates:{x:850,y:400},fileSystem:{files:["access-log.txt","badge-ids.db"],directories:["logs","config"]}},{id:"scada-plc-01",ip:"10.0.0.100",hostname:"plc-controller-01",type:"scada",ports:[{number:502,status:"open",service:"modbus",vulnerability:{id:"scada-no-auth",name:"SCADA No Authentication",description:"Industrial control system lacks authentication",exploitCommand:"exploit scada-no-auth 10.0.0.100",requiredTools:["nessus"],successRate:.85,detectability:.7}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:7,coordinates:{x:400,y:450},fileSystem:{files:["plc-program.ladder","process-values.csv","alarm-log.txt"],directories:["programs","logs","backups"]}},{id:"scada-hmi",ip:"10.0.0.110",hostname:"scada-hmi-01",type:"scada",ports:[{number:80,status:"open",service:"http",vulnerability:{id:"scada-hmi-exploit",name:"HMI Buffer Overflow",description:"SCADA HMI vulnerable to buffer overflow",exploitCommand:"exploit scada-hmi-exploit 10.0.0.110",requiredTools:["metasploit"],successRate:.6,detectability:.8}},{number:502,status:"open",service:"modbus"}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:7,coordinates:{x:450,y:480},fileSystem:{files:["scada-config.xml","runtime-data.db","operator-logs.txt"],directories:["config","data","logs"]}},{id:"corp-db-02",ip:"192.168.1.21",hostname:"analytics-db",type:"database",ports:[{number:5432,status:"open",service:"postgresql",vulnerability:{id:"postgres-sql-injection",name:"PostgreSQL Injection",description:"Application layer SQL injection vulnerability",exploitCommand:"exploit postgres-sql-injection 192.168.1.21",requiredTools:["sqlmap"],successRate:.7,detectability:.45}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:5,coordinates:{x:650,y:120},fileSystem:{files:["analytics.db","metrics.db","reports.csv"],directories:["data","reports","backup"]}},{id:"corp-workstation-03",ip:"192.168.1.52",hostname:"exec-workstation",type:"workstation",ports:[{number:3389,status:"open",service:"rdp",vulnerability:{id:"rdp-weak-auth",name:"Weak RDP Password",description:"RDP uses easily guessable password",exploitCommand:"exploit rdp-weak-auth 192.168.1.52",requiredTools:["hydra"],successRate:.75,detectability:.5}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:3,coordinates:{x:750,y:140},fileSystem:{files:["executive-emails.pst","strategic-plan.docx","budget.xlsx"],directories:["documents","desktop"]}},{id:"dmz-vpn-gateway",ip:"172.16.0.30",hostname:"vpn-gateway",type:"firewall",ports:[{number:1194,status:"open",service:"openvpn",vulnerability:{id:"vpn-config-leak",name:"VPN Configuration Leak",description:"VPN configuration files publicly accessible",exploitCommand:"exploit vpn-config-leak 172.16.0.30",successRate:.8,detectability:.25}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:4,coordinates:{x:450,y:320},fileSystem:{files:["vpn-config.ovpn","client-certs.zip","connection-log.txt"],directories:["config","certs","logs"]}},{id:"internal-mail-02",ip:"10.0.0.40",hostname:"internal-exchange",type:"mail-server",ports:[{number:25,status:"open",service:"smtp"},{number:587,status:"open",service:"smtp",vulnerability:{id:"exchange-proxylogon",name:"ProxyLogon Exchange Exploit",description:"Exchange server vulnerable to ProxyLogon",exploitCommand:"exploit exchange-proxylogon 10.0.0.40",requiredTools:["metasploit"],successRate:.65,detectability:.6}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:6,coordinates:{x:300,y:450},fileSystem:{files:["mailboxes.db","calendar.db","contacts.db"],directories:["mailboxes","logs","queue"]}},{id:"cloud-container-host",ip:"203.0.113.50",hostname:"docker-host-01",type:"server",ports:[{number:2375,status:"open",service:"docker",vulnerability:{id:"docker-exposed-api",name:"Exposed Docker API",description:"Docker API accessible without authentication",exploitCommand:"exploit docker-exposed-api 203.0.113.50",successRate:.9,detectability:.35}},{number:22,status:"open",service:"ssh"}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:5,coordinates:{x:150,y:150},fileSystem:{files:["docker-compose.yml","container-logs.txt","images.tar"],directories:["containers","volumes","logs"]}},{id:"iot-printer",ip:"192.168.2.40",hostname:"network-printer-01",type:"iot-device",ports:[{number:9100,status:"open",service:"jetdirect",vulnerability:{id:"printer-data-leak",name:"Printer Data Leak",description:"Network printer exposes print job data",exploitCommand:"exploit printer-data-leak 192.168.2.40",successRate:.9,detectability:.2}},{number:80,status:"open",service:"http"}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:1,coordinates:{x:900,y:250},fileSystem:{files:["print-queue.log","scanned-docs.pdf"],directories:["jobs","logs"]}},{id:"corp-vpn-server",ip:"192.168.1.5",hostname:"vpn-server-01",type:"server",ports:[{number:1194,status:"open",service:"openvpn",vulnerability:{id:"vpn-weak-crypto",name:"Weak VPN Encryption",description:"VPN uses deprecated encryption algorithms",exploitCommand:"exploit vpn-weak-crypto 192.168.1.5",requiredTools:["nessus"],successRate:.55,detectability:.5}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:4,coordinates:{x:500,y:180},fileSystem:{files:["vpn-users.db","auth-log.txt","server.conf"],directories:["config","logs","certs"]}},{id:"internal-nfs-server",ip:"10.0.0.50",hostname:"nfs-storage-01",type:"file-server",ports:[{number:2049,status:"open",service:"nfs",vulnerability:{id:"nfs-no-auth",name:"NFS No Authentication",description:"NFS shares exported without authentication",exploitCommand:"exploit nfs-no-auth 10.0.0.50",successRate:.9,detectability:.25}}],accessLevel:"none",isDiscovered:!1,isOnline:!0,securityLevel:3,coordinates:{x:350,y:480},fileSystem:{files:["shared-data.tar","exports.conf","nfs-log.txt"],directories:["shared","home","projects"]}}];this.state.hosts[e.ip]=e,t.forEach(i=>{this.state.hosts[i.ip]=i})}getState(){return m({},this.state)}getNetworkState(){return{hosts:Object.values(this.state.hosts),connections:this.state.connections,currentConnection:this.getActiveConnection(),detectionLevel:this.getDetectionLevel()}}getCurrentHost(){return this.state.hosts[this.state.currentHost]}getHost(e){return this.state.hosts[e]}getAllHosts(){return Object.values(this.state.hosts)}getDiscoveredHosts(){return Object.values(this.state.hosts).filter(e=>e.isDiscovered)}scan(e,t="quick"){if(e.includes("/")){let a=e.split("/")[0],l=a.substring(0,a.lastIndexOf(".")),v=Object.values(this.state.hosts).filter(S=>S.ip.startsWith(l)&&S.ip!==this.state.playerIp);v.forEach(S=>{S.isDiscovered=!0});let y=t==="stealth"?.5:t==="full"?2:1;return this.state.detectionLevel+=this.state.alarmTriggered?y*2:y,this.checkDetectionWarnings(),this.checkAlarmTrigger(),this.resetDecayTimer(),this.updateSignal(),{success:!0,hostsFound:v}}let i=this.state.hosts[e];if(!i||!i.isOnline)return{success:!1,error:`Host ${e} not found or offline`,hostsFound:[]};i.isDiscovered=!0;let s=i.ports.filter(a=>a.status==="open"),r=s.filter(a=>a.vulnerability).map(a=>a.vulnerability),o={host:e,timestamp:Date.now(),openPorts:s,vulnerabilities:r,scanType:t,osGuess:i.type==="server"?"Linux":"Windows"};this.state.scanHistory.push(o);let n=t==="full"?2:t==="stealth"?.5:1;return this.state.detectionLevel+=this.state.alarmTriggered?n*2:n,this.checkDetectionWarnings(),this.checkAlarmTrigger(e),this.resetDecayTimer(),this.updateSignal(),{success:!0,hostsFound:[i]}}exploit(e,t){let i=this.state.hosts[e];if(!i)return{success:!1,error:"Host not found"};let s;if(typeof t=="number"?s=i.ports.find(l=>l.number===t&&l.vulnerability):s=i.ports.find(l=>l.vulnerability?.id===t),!s?.vulnerability)return{success:!1,error:"No vulnerability found on this port"};let r=s.vulnerability,o=Math.random()<r.successRate,n=Math.random()<r.detectability;this.resetDecayTimer(),n&&(this.state.detectionLevel+=this.state.alarmTriggered?20:10,this.checkDetectionWarnings(),this.checkAlarmTrigger(e),this.updateSignal());let a={success:o,message:o?`Successfully exploited ${r.name} on ${e}`:`Exploit failed for ${r.name} on ${e}`,accessLevel:o?"user":void 0,detected:n,loot:o&&i.fileSystem?i.fileSystem.files.slice(0,2):void 0};return o&&(i.accessLevel="user"),this.state.exploitHistory.push(a),this.updateSignal(),{success:o,error:o?void 0:`Exploit failed for ${r.name}`,vulnerability:r,accessLevel:a.accessLevel}}connect(e){let t=this.state.hosts[e];if(!t||!t.isOnline)return{success:!1,error:"Host not found or offline"};if(t.accessLevel==="none")return{success:!1,error:"Access denied - no credentials"};let i={from:this.state.currentHost,to:e,timestamp:Date.now(),status:"active"};return this.state.connections.filter(s=>s.status==="active").forEach(s=>{s.status="inactive"}),this.state.connections.push(i),this.state.currentHost=e,this.updateSignal(),{success:!0,hostname:t.hostname,accessLevel:t.accessLevel}}disconnect(){if(this.state.currentHost===this.state.playerIp)return{success:!1,error:"Not connected to any remote host"};let e=this.state.currentHost,t=this.state.hosts[e];return this.state.connections.filter(i=>i.status==="active").forEach(i=>{i.status="inactive"}),this.state.currentHost=this.state.playerIp,this.updateSignal(),{success:!0,previousHost:t?.hostname||e}}getActiveConnection(){return this.state.connections.find(e=>e.status==="active")}elevateAccess(e){let t=this.state.hosts[e];if(!t||t.accessLevel!=="user")return!1;if(Math.random()<.3){t.accessLevel="root";let i=5;return this.state.detectionLevel+=this.state.alarmTriggered?i*2:i,this.checkDetectionWarnings(),this.checkAlarmTrigger(e),this.resetDecayTimer(),!0}return!1}getDetectionLevel(){return Math.min(100,this.state.detectionLevel)}isAlarmActive(){return this.state.alarmTriggered}checkAlarmTrigger(e){if(this.state.alarmTriggered)return;let t=e?this.state.hosts[e]:this.state.hosts[this.state.currentHost];t&&t.securityLevel>=7&&this.state.detectionLevel>=80&&(this.state.alarmTriggered=!0,this.notificationService.error("ALARM TRIGGERED",`\u{1F6A8} Security alarm triggered on ${t.hostname}! Detection rate doubled!`),this.audioService.playSfx("alarm_triggered"),this.updateSignal())}checkDetectionWarnings(){let e=this.state.detectionLevel,t=[{level:90,message:"\u26A0\uFE0F CRITICAL: Detection at 90%!"},{level:75,message:"\u26A0\uFE0F High detection risk at 75%"},{level:50,message:"\u26A0\uFE0F Elevated detection at 50%"}];for(let i of t)if(e>=i.level&&!this.warningThresholdsTriggered.has(i.level)){this.warningThresholdsTriggered.add(i.level),this.notificationService.warning("Detection Warning",i.message),this.audioService.playSfx("detection_warning");break}}resetDetection(){this.state.detectionLevel=0,this.state.alarmTriggered=!1,this.warningThresholdsTriggered.clear()}startDecayTimer(){this.stopDecayTimer(),this.decayTimer=window.setInterval(()=>{this.applyDecay()},this.DECAY_INTERVAL)}stopDecayTimer(){this.decayTimer!==void 0&&(clearInterval(this.decayTimer),this.decayTimer=void 0)}resetDecayTimer(){this.startDecayTimer()}applyDecay(){if(!this.state.alarmTriggered&&this.state.detectionLevel>0){let e=this.state.detectionLevel;this.state.detectionLevel=Math.max(0,this.state.detectionLevel-this.DECAY_AMOUNT),e>0&&this.state.detectionLevel<e&&[50,75,90].forEach(i=>{e>=i&&this.state.detectionLevel<i&&this.warningThresholdsTriggered.delete(i)}),this.updateSignal()}}serialize(){return JSON.stringify(this.state)}deserialize(e){try{let t=JSON.parse(e);this.state=t,this.updateSignal()}catch(t){console.error("Failed to deserialize network state:",t),this.state={hosts:{},connections:[],currentHost:"127.0.0.1",scanHistory:[],exploitHistory:[],playerIp:"127.0.0.1",detectionLevel:0,alarmTriggered:!1},this.initializeNetwork(),this.updateSignal()}}reset(){this.state={hosts:{},connections:[],currentHost:"127.0.0.1",scanHistory:[],exploitHistory:[],playerIp:"127.0.0.1",detectionLevel:0,alarmTriggered:!1},this.initializeNetwork(),this.updateSignal()}setSandboxMode(e){this.sandboxMode=e}createSandboxSnapshot(){return this.serialize()}restoreSandboxSnapshot(e){this.deserialize(e)}static \u0275fac=function(t){return new(t||d)};static \u0275prov=h({token:d,factory:d.\u0275fac,providedIn:"root"})};var T=class d{adapter;constructor(){this.adapter=this.initializeAdapter()}initializeAdapter(){return this.isIndexedDBSupported()?new N:new R}isIndexedDBSupported(){return typeof indexedDB<"u"}get(e){return u(this,null,function*(){return this.adapter.get(e)})}set(e,t){return u(this,null,function*(){return this.adapter.set(e,t)})}remove(e){return u(this,null,function*(){return this.adapter.remove(e)})}clear(){return u(this,null,function*(){return this.adapter.clear()})}keys(){return u(this,null,function*(){return this.adapter.keys()})}static \u0275fac=function(t){return new(t||d)};static \u0275prov=h({token:d,factory:d.\u0275fac,providedIn:"root"})},N=class{DB_NAME="webos-db";STORE_NAME="storage";DB_VERSION=1;db=null;getDB(){return u(this,null,function*(){return this.db?this.db:new Promise((e,t)=>{let i=indexedDB.open(this.DB_NAME,this.DB_VERSION);i.onerror=()=>t(i.error),i.onsuccess=()=>{this.db=i.result,e(i.result)},i.onupgradeneeded=s=>{let r=s.target.result;r.objectStoreNames.contains(this.STORE_NAME)||r.createObjectStore(this.STORE_NAME)}})})}get(e){return u(this,null,function*(){let t=yield this.getDB();return new Promise((i,s)=>{let n=t.transaction(this.STORE_NAME,"readonly").objectStore(this.STORE_NAME).get(e);n.onsuccess=()=>i(n.result??null),n.onerror=()=>s(n.error)})})}set(e,t){return u(this,null,function*(){let i=yield this.getDB();return new Promise((s,r)=>{let a=i.transaction(this.STORE_NAME,"readwrite").objectStore(this.STORE_NAME).put(t,e);a.onsuccess=()=>s(),a.onerror=()=>r(a.error)})})}remove(e){return u(this,null,function*(){let t=yield this.getDB();return new Promise((i,s)=>{let n=t.transaction(this.STORE_NAME,"readwrite").objectStore(this.STORE_NAME).delete(e);n.onsuccess=()=>i(),n.onerror=()=>s(n.error)})})}clear(){return u(this,null,function*(){let e=yield this.getDB();return new Promise((t,i)=>{let o=e.transaction(this.STORE_NAME,"readwrite").objectStore(this.STORE_NAME).clear();o.onsuccess=()=>t(),o.onerror=()=>i(o.error)})})}keys(){return u(this,null,function*(){let e=yield this.getDB();return new Promise((t,i)=>{let o=e.transaction(this.STORE_NAME,"readonly").objectStore(this.STORE_NAME).getAllKeys();o.onsuccess=()=>t(o.result),o.onerror=()=>i(o.error)})})}},R=class{get(e){return u(this,null,function*(){let t=localStorage.getItem(e);if(t===null)return null;try{return JSON.parse(t)}catch{return t}})}set(e,t){return u(this,null,function*(){localStorage.setItem(e,JSON.stringify(t))})}remove(e){return u(this,null,function*(){localStorage.removeItem(e)})}clear(){return u(this,null,function*(){localStorage.clear()})}keys(){return u(this,null,function*(){return Object.keys(localStorage)})}};var x=class d{constructor(e,t){this.storage=e;this.notificationService=t;this.loadProgress()}achievements=c([{id:"first_login",title:"Welcome Aboard",description:"Successfully log in to WebOS for the first time",icon:"\u{1F389}",points:10,unlocked:!1,category:"basics"},{id:"open_terminal",title:"Command Line Hero",description:"Open the terminal application",icon:"\u{1F4BB}",points:10,unlocked:!1,category:"basics"},{id:"run_first_command",title:"First Command",description:"Execute your first terminal command",icon:"\u26A1",points:15,unlocked:!1,category:"basics",prerequisite:["open_terminal"]},{id:"open_file_manager",title:"File Explorer",description:"Open the file manager",icon:"\u{1F4C1}",points:10,unlocked:!1,category:"basics"},{id:"create_first_file",title:"Content Creator",description:"Create your first file",icon:"\u{1F4DD}",points:15,unlocked:!1,category:"basics"},{id:"first_scan",title:"Network Scanner",description:"Successfully scan a network",icon:"\u{1F50D}",points:20,unlocked:!1,category:"exploration"},{id:"first_hack",title:"Script Kiddie",description:"Successfully hack your first target",icon:"\u{1F513}",points:30,unlocked:!1,category:"hacking",prerequisite:["first_scan"]},{id:"complete_tutorial",title:"Graduate",description:"Complete all tutorial sections (+500 credits)",icon:"\u{1F393}",points:50,unlocked:!1,category:"basics"},{id:"tutorial_speedrun",title:"Speed Learner",description:"Complete the tutorial in under 10 minutes (+250 credits)",icon:"\u26A1",points:75,unlocked:!1,category:"basics",prerequisite:["complete_tutorial"]},{id:"tutorial_perfectionist",title:"Perfectionist",description:"Complete the tutorial without skipping any sections (+300 credits)",icon:"\u{1F4AF}",points:60,unlocked:!1,category:"basics"},{id:"first_sandbox_practice",title:"Practice Makes Perfect",description:"Complete a practice mission in sandbox mode",icon:"\u{1F9EA}",points:25,unlocked:!1,category:"basics"},{id:"first_command",title:"First Command",description:"Execute your first command in the tutorial",icon:"\u2328\uFE0F",points:10,unlocked:!1,category:"basics"},{id:"first_hack",title:"First Hack",description:"Successfully hack your first target in the tutorial",icon:"\u{1F3AF}",points:20,unlocked:!1,category:"basics"},{id:"earn_1000",title:"Moneymaker",description:"Earn 1,000 credits",icon:"\u{1F4B0}",points:25,unlocked:!1,category:"economy"},{id:"first_script",title:"Automation Rookie",description:"Write and execute your first script",icon:"\u{1F916}",points:30,unlocked:!1,category:"advanced"},{id:"complete_mission",title:"Mission Accomplished",description:"Complete your first mission",icon:"\u2705",points:40,unlocked:!1,category:"advanced"},{id:"master_hacker",title:"Master Hacker",description:"Successfully hack 10 targets",icon:"\u{1F451}",points:100,unlocked:!1,category:"hacking",prerequisite:["first_hack"]}]);milestones=c([{id:"commands_executed",title:"Command Execution",description:"Total commands executed",progress:0,target:100},{id:"files_created",title:"File Creation",description:"Files created",progress:0,target:50},{id:"networks_scanned",title:"Network Scanning",description:"Networks scanned",progress:0,target:20},{id:"credits_earned",title:"Wealth Accumulation",description:"Total credits earned",progress:0,target:1e4,reward:{type:"unlock",value:"premium_tools"}}]);skills=c([{id:"hack_speed",name:"Fast Cracking",description:"Increase hacking speed by 10% per level",icon:"\u26A1",level:0,maxLevel:5,cost:100,category:"hacking",effect:{type:"hack_speed_multiplier",value:.1}},{id:"trace_resistance",name:"Trace Evasion",description:"Increase trace resistance by 15% per level",icon:"\u{1F6E1}\uFE0F",level:0,maxLevel:5,cost:150,category:"stealth",effect:{type:"trace_resistance_multiplier",value:.15}},{id:"income_boost",name:"Negotiator",description:"Increase mission rewards by 20% per level",icon:"\u{1F4BC}",level:0,maxLevel:3,cost:200,category:"economy",effect:{type:"income_multiplier",value:.2}},{id:"scan_depth",name:"Deep Scanner",description:"Reveal more information when scanning",icon:"\u{1F52C}",level:0,maxLevel:3,cost:120,category:"hacking",prerequisite:["hack_speed"],effect:{type:"scan_detail_level",value:1}},{id:"auto_scripts",name:"Script Master",description:"Unlock advanced scripting features",icon:"\u{1F9D9}",level:0,maxLevel:3,cost:250,category:"automation",prerequisite:["hack_speed"],effect:{type:"script_features_unlocked",value:1}}]);totalPoints=c(0);tutorialStartTime;startTutorialTimer(){this.tutorialStartTime=Date.now()}checkTutorialSpeedrun(){if(!this.tutorialStartTime)return!1;let e=Date.now()-this.tutorialStartTime,t=600*1e3;return e<t}unlockAchievement(e){return u(this,null,function*(){let t=this.achievements().find(i=>i.id===e);return!t||t.unlocked||t.prerequisite&&!t.prerequisite.every(s=>this.achievements().find(r=>r.id===s)?.unlocked)?!1:(this.achievements.update(i=>i.map(s=>s.id===e?(this.totalPoints.update(r=>r+s.points),p(m({},s),{unlocked:!0,unlockedAt:Date.now()})):s)),this.notificationService.achievement(t.title,t.description,t.icon,t.points),yield this.saveProgress(),!0)})}updateMilestone(e,t){this.milestones.update(i=>i.map(s=>s.id===e?p(m({},s),{progress:Math.min(t,s.target)}):s)),this.saveProgress()}incrementMilestone(e,t=1){let i=this.milestones().find(s=>s.id===e);i&&this.updateMilestone(e,i.progress+t)}upgradeSkill(e){let t=this.skills().find(i=>i.id===e);return!t||t.level>=t.maxLevel||t.prerequisite&&!t.prerequisite.every(s=>{let r=this.skills().find(o=>o.id===s);return r&&r.level>0})?!1:(this.skills.update(i=>i.map(s=>s.id===e?p(m({},s),{level:s.level+1}):s)),this.saveProgress(),!0)}getSkillEffect(e){let t=this.skills().find(i=>i.id===e);return t?t.level*t.effect.value:0}loadProgress(){return u(this,null,function*(){try{let e=yield this.storage.get("webos.achievements");e&&(this.achievements.set(e.achievements),this.milestones.set(e.milestones),this.skills.set(e.skills),this.totalPoints.set(e.totalPoints))}catch(e){console.error("Failed to load achievement progress:",e)}})}saveProgress(){return u(this,null,function*(){try{yield this.storage.set("webos.achievements",{achievements:this.achievements(),milestones:this.milestones(),skills:this.skills(),totalPoints:this.totalPoints()})}catch(e){console.error("Failed to save achievement progress:",e)}})}reset(){this.achievements.update(e=>e.map(t=>p(m({},t),{unlocked:!1,unlockedAt:void 0}))),this.milestones.update(e=>e.map(t=>p(m({},t),{progress:0}))),this.skills.update(e=>e.map(t=>p(m({},t),{level:0}))),this.totalPoints.set(0),this.saveProgress()}static \u0275fac=function(t){return new(t||d)(D(T),D(g))};static \u0275prov=h({token:d,factory:d.\u0275fac,providedIn:"root"})};var P=class d{notificationService=f(g);economyService=f(E);networkService=f(M);achievementService=f(x);missions=c([]);nextMissionId=1;playerReputations=c([]);playerStats=c({missionsCompleted:0,missionsFailed:0,totalMissionsAttempted:0});missionHistory=c([]);gameDifficulty=c("normal");sandboxMode=!1;CLIENT_NAMES=["Anonymous Client","CyberCorp","DataSecure Inc","NetGuard Systems","InfoTech Solutions","SecureNet Corp","TechVentures","Digital Dynamics","CyberSolutions Ltd","NetSafe Technologies"];FACTIONS=[{id:"corporate",name:"Corporate",description:"Multinational corporations seeking competitive advantage",color:"#0066cc",relationships:new Map([["underground","neutral"],["government","ally"],["activist","hostile"],["criminal","hostile"],["security","ally"]])},{id:"underground",name:"Underground",description:"Hacktivists and independent operatives",color:"#00aa00",relationships:new Map([["corporate","neutral"],["government","hostile"],["activist","ally"],["criminal","neutral"],["security","hostile"]])},{id:"government",name:"Government",description:"State-sponsored intelligence agencies",color:"#cc0000",relationships:new Map([["corporate","ally"],["underground","hostile"],["activist","hostile"],["criminal","hostile"],["security","ally"]])},{id:"activist",name:"Activist",description:"Freedom fighters and whistleblowers",color:"#ff9900",relationships:new Map([["corporate","hostile"],["underground","ally"],["government","hostile"],["criminal","neutral"],["security","hostile"]])},{id:"criminal",name:"Criminal",description:"Organized crime and black market operators",color:"#990099",relationships:new Map([["corporate","hostile"],["underground","neutral"],["government","hostile"],["activist","neutral"],["security","hostile"]])},{id:"security",name:"Security",description:"Private security firms and defensive contractors",color:"#0099cc",relationships:new Map([["corporate","ally"],["underground","hostile"],["government","ally"],["activist","hostile"],["criminal","hostile"]])}];REPUTATION_THRESHOLDS=[{level:"Hated",minReputation:-1e3,unlocks:[]},{level:"Hostile",minReputation:-500,unlocks:[]},{level:"Unfriendly",minReputation:-100,unlocks:[]},{level:"Neutral",minReputation:0,unlocks:[]},{level:"Friendly",minReputation:100,unlocks:["tier2_missions"]},{level:"Honored",minReputation:500,unlocks:["tier3_missions","faction_gear"]},{level:"Revered",minReputation:1e3,unlocks:["tier4_missions","faction_exclusive"]},{level:"Exalted",minReputation:2500,unlocks:["tier5_missions","faction_elite"]}];constructor(){this.loadMissions(),this.loadReputations(),this.initializeReputations(),this.loadPlayerStats(),this.loadMissionHistory(),this.loadGameDifficulty()}get missions$(){return this.missions.asReadonly()}get playerStats$(){return this.playerStats.asReadonly()}get missionHistory$(){return this.missionHistory.asReadonly()}getGameDifficulty(){return this.gameDifficulty()}setGameDifficulty(e){this.gameDifficulty.set(e),this.saveGameDifficulty()}getDifficultyMultiplier(){switch(this.gameDifficulty()){case"easy":return .5;case"hard":return 1.5;default:return 1}}getPlayerStats(){return this.playerStats()}getCredits(){return this.economyService.getBalance()}getMissionHistory(){return this.missionHistory()}getMissionStatistics(){let e=this.playerStats(),t=e.totalMissionsAttempted,i=e.missionsCompleted,s=e.missionsFailed,r=t>0?i/t*100:0;return{completed:i,failed:s,total:t,successRate:r}}getMission(e){return this.missions().find(t=>t.id===e)}getAvailableMissions(){return this.missions().filter(e=>e.status==="available")}getActiveMissions(){return this.missions().filter(e=>e.status==="active")}getCompletedMissions(){return this.missions().filter(e=>e.status==="completed")}generateMission(e){let t={minDifficulty:"easy",maxDifficulty:"hard",objectiveCount:1,timeLimitMultiplier:1,rewardMultiplier:1},i=m(m({},t),e),s=this.randomDifficulty(i.minDifficulty,i.maxDifficulty),r=Math.max(1,i.objectiveCount),o=this.generateObjectives(r,s),n=this.calculateReward(o,s,i.rewardMultiplier),a=this.calculateTimeLimit(o,s,i.timeLimitMultiplier),l={id:`mission_${this.nextMissionId++}`,title:this.generateMissionTitle(o[0].type,s),description:this.generateMissionDescription(o),difficulty:s,status:"available",objectives:o,reward:n,timeLimit:a,expiresAt:Date.now()+1440*60*1e3,clientName:this.randomElement(this.CLIENT_NAMES),clientFaction:this.randomElement(this.FACTIONS).id,targetNetwork:this.generateTargetNetwork(),stealthRequired:Math.random()<.3,consequences:{success:"Payment will be transferred upon completion.",failure:"No payment will be issued. Reputation loss may occur."}};return this.addMission(l),l}acceptMission(e){let t=this.getMission(e);return!t||t.status!=="available"?!1:(this.updateMission(e,{status:"active",startTime:Date.now()}),this.saveMissions(),!0)}completeMission(e){let t=this.getMission(e);if(!t||t.status!=="active"||!t.objectives.every(r=>r.completed))return null;let s=Date.now();return this.updateMission(e,{status:"completed",completedAt:s}),t.clientFaction&&this.updateReputation(t.clientFaction,t.reward.reputation||0,t),this.distributeReward(t.reward),this.updateStats({missionsCompleted:1,totalMissionsAttempted:1}),this.addToHistory({missionId:t.id,title:t.title,difficulty:t.difficulty,status:"completed",reward:t.reward,completedAt:s,clientFaction:t.clientFaction}),this.sandboxMode&&this.achievementService.unlockAchievement("first_sandbox_practice"),this.saveMissions(),t.reward}failMission(e,t){let i=this.getMission(e);if(!i||i.status!=="active")return!1;let s=Date.now();this.updateMission(e,{status:"failed",failedAt:s});let o=t?.includes("Detected")?.25:.5;if(i.clientFaction){let n=Math.floor((i.reward.reputation||0)*o);this.updateReputation(i.clientFaction,-n,i)}return this.updateStats({missionsFailed:1,totalMissionsAttempted:1}),this.addToHistory({missionId:i.id,title:i.title,difficulty:i.difficulty,status:"failed",reward:i.reward,failedAt:s,clientFaction:i.clientFaction}),t&&this.notificationService.show(`Mission Failed: ${t}`,"error"),this.saveMissions(),!0}abandonMission(e){let t=this.getMission(e);if(!t||t.status!=="active")return!1;let i=Date.now();if(this.updateMission(e,{status:"failed",failedAt:i}),t.clientFaction){let s=Math.floor((t.reward.reputation||0)*.5);this.updateReputation(t.clientFaction,-s,t)}return this.updateStats({missionsFailed:1,totalMissionsAttempted:1}),this.addToHistory({missionId:t.id,title:t.title,difficulty:t.difficulty,status:"failed",reward:t.reward,failedAt:i,clientFaction:t.clientFaction}),this.notificationService.show("Mission abandoned. Reputation penalty applied.","warning"),this.saveMissions(),!0}detectionWarnings=new Map;checkDetectionFailure(){let e=this.missions().filter(i=>i.status==="active"),t=this.networkService.getDetectionLevel();for(let i of e)i.stealthRequired&&t>=100&&(this.notificationService.show("Mission Failed: Detected by security systems","error"),this.failMission(i.id,"Detected by security systems")),i.stealthRequired&&this.checkDetectionWarnings(i,t)}checkDetectionWarnings(e,t){let i=[{level:90,title:"Critical Detection Level",message:"Detection at 90%! Immediate action required!"},{level:75,title:"High Detection Level",message:"Detection at 75%. Exercise extreme caution."},{level:50,title:"Detection Warning",message:"Detection at 50%. Slow down and be careful."}];this.detectionWarnings.has(e.id)||this.detectionWarnings.set(e.id,new Set);let s=this.detectionWarnings.get(e.id);for(let r of i)if(t>=r.level&&!s.has(r.level)){s.add(r.level),this.notificationService.warning(r.title,r.message);break}}updateObjectiveProgress(e,t,i){let s=this.getMission(e);if(!s||s.status!=="active")return!1;let r=s.objectives.find(n=>n.id===t);return r?(r.progress=i,r.maxProgress&&i>=r.maxProgress&&(r.completed=!0),this.updateMission(e,{objectives:s.objectives}),this.saveMissions(),s.objectives.every(n=>n.completed)&&this.completeMission(e),!0):!1}completeObjective(e,t){let i=this.getMission(e);if(!i||i.status!=="active")return!1;let s=i.objectives.find(o=>o.id===t);return s?(s.completed=!0,this.updateMission(e,{objectives:i.objectives}),this.saveMissions(),i.objectives.every(o=>o.completed)&&this.completeMission(e),!0):!1}checkObjectiveCompletion(e,t,i){if(!i.success)return{completed:!1};let s=this.missions().filter(r=>r.status==="active");for(let r of s)for(let o of r.objectives){if(o.completed)continue;let n=!1;switch(o.type){case"hack_server":e==="exploit"&&i.target===o.target&&(n=!0);break;case"steal_file":e==="download"&&i.target===o.target&&i.targetFile===o.targetFile&&(n=!0);break;case"delete_file":e==="rm"&&i.target===o.target&&i.targetFile===o.targetFile&&(n=!0);break;case"upload_file":e==="upload"&&i.target===o.target&&i.targetFile===o.targetFile&&(n=!0);break;case"install_backdoor":e==="exploit"&&i.target===o.target&&i.data?.backdoor===!0&&(n=!0);break;case"clear_logs":e==="rm"&&i.target===o.target&&i.targetFile?.includes("/var/log/")&&(n=!0);break;case"transfer_funds":e==="transfer"&&i.target===o.target&&i.data?.amount>=(o.targetAmount||0)&&(n=!0);break;case"crack_password":e==="crack"&&i.target===o.target&&(n=!0);break;case"scan_network":e==="scan"&&i.target===o.target&&(n=!0);break}if(n){this.completeObjective(r.id,o.id),this.notificationService.info("Objective Complete",o.description);let a=r.objectives.filter(v=>!v.completed&&v.id!==o.id),l=a.length>0?`Mission progress: ${r.objectives.length-a.length}/${r.objectives.length} objectives complete`:"All objectives complete! Mission accomplished.";return{completed:!0,objectiveId:o.id,missionId:r.id,message:l}}}return{completed:!1}}checkExpiredMissions(){let e=Date.now(),t=this.missions().filter(s=>s.status==="available"&&s.expiresAt&&s.expiresAt<e);t.forEach(s=>{this.updateMission(s.id,{status:"expired"}),this.notificationService.show(`Mission expired: ${s.title}`,"warning")});let i=this.missions().filter(s=>s.status==="active"&&s.timeLimit&&s.startTime&&Date.now()-s.startTime>s.timeLimit);i.forEach(s=>{this.failMission(s.id,"Time limit exceeded")}),(t.length>0||i.length>0)&&this.saveMissions()}clearCompletedMissions(){this.missions.update(e=>e.filter(t=>t.status!=="completed"&&t.status!=="failed")),this.saveMissions()}clearAllMissions(){this.missions.set([]),this.saveMissions()}deliverMissionsToEmail(e=3){let t=this.getPlayerLevel();return this.generateContractBatch(t,e)}generateContractBatch(e,t=3){let i=this.getConfigForPlayerLevel(e),s=[];for(let r=0;r<t;r++){let o=this.randomizeConfig(i,r);s.push(this.generateMission(o))}return s}getPlayerLevel(){let e=this.getCompletedMissions();if(e.length===0)return 1;let t=e.reduce((i,s)=>i+(s.reward.reputation||0),0);return Math.floor(t/100)+1}getRecommendedDifficulty(e){return e<=2?"easy":e<=5?"medium":e<=10?"hard":"expert"}getConfigForPlayerLevel(e){let t=this.getRecommendedDifficulty(e),i=Math.min(1+Math.floor(e/3),4),s=1+e*.1,r=Math.max(.5,1.5-e*.05),o="easy",n=t;return e>=3&&(o="medium"),e>=6&&(o="hard"),{minDifficulty:o,maxDifficulty:n,objectiveCount:i,timeLimitMultiplier:r,rewardMultiplier:s}}randomizeConfig(e,t){let i=Math.floor(Math.random()*3)-1,s=Math.max(1,(e.objectiveCount||1)+i),r=.8+Math.random()*.4,o=(e.rewardMultiplier||1)*r,n=.9+Math.random()*.2,a=(e.timeLimitMultiplier||1)*n;return{minDifficulty:e.minDifficulty,maxDifficulty:e.maxDifficulty,objectiveCount:s,rewardMultiplier:o,timeLimitMultiplier:a}}addMission(e){this.missions.update(t=>[...t,e]),this.saveMissions()}updateMission(e,t){this.missions.update(i=>i.map(s=>s.id===e?m(m({},s),t):s))}generateObjectives(e,t){let i=Object.values(k),s=[];for(let r=0;r<e;r++){let o=this.randomElement(i),n={id:`obj_${r+1}`,type:o,description:this.generateObjectiveDescription(o,t),completed:!1};(o==="steal_file"||o==="delete_file")&&(n.targetFile=this.generateTargetFile()),o==="scan_network"&&(n.maxProgress=this.getDifficultyValue(t,3,5,10,15)),o==="transfer_funds"&&(n.targetAmount=this.getDifficultyValue(t,1e3,5e3,1e4,5e4)),s.push(n)}return s}generateObjectiveDescription(e,t){return{hack_server:`Gain ${this.getDifficultyAccess(t)} access to target server`,steal_file:"Download sensitive file from target system",upload_file:"Upload malware to target server",delete_file:"Delete evidence from target system",scan_network:"Scan and map the target network",crack_password:"Crack administrator password",install_backdoor:"Install persistent backdoor access",clear_logs:"Clear all traces from system logs",transfer_funds:"Transfer funds from target account"}[e]}generateMissionTitle(e,t){let s={hack_server:["Server Infiltration","System Breach","Network Penetration"],steal_file:["Data Extraction","File Theft","Document Recovery"],upload_file:["Malware Deployment","Payload Installation","Trojan Upload"],delete_file:["Evidence Removal","File Deletion","Data Sanitization"],scan_network:["Network Reconnaissance","Infrastructure Mapping","System Discovery"],crack_password:["Password Breach","Credential Theft","Access Recovery"],install_backdoor:["Backdoor Installation","Persistent Access","Remote Control"],clear_logs:["Log Clearing","Trace Removal","Evidence Cleanup"],transfer_funds:["Fund Transfer","Financial Extraction","Account Drain"]}[e];return`${this.randomElement(s)} [${t.toUpperCase()}]`}generateMissionDescription(e){let t=["A client requires your specialized services for a sensitive operation.","We need someone with your skills for a discrete task.","Time-sensitive job opportunity. Discretion guaranteed.","High-value target requires professional handling.","Corporate espionage contract. Handle with care."];return this.randomElement(t)}generateTargetNetwork(){let e=["192.168.1.0/24","10.0.0.0/24","172.16.0.0/24","203.0.113.0/24","192.168.2.0/24"];return this.randomElement(e)}generateTargetFile(){let e=["/data/financial_records.db","/home/admin/passwords.txt","/var/logs/access.log","/root/confidential.doc","/etc/shadow","/data/customer_database.sql","/home/user/secrets.txt"];return this.randomElement(e)}calculateReward(e,t,i){let s=this.getDifficultyValue(t,1e3,2500,5e3,1e4),r=(e.length-1)*500,o=this.getDifficultyMultiplier(),n=Math.floor((s+r)*i*o),a=Math.floor(this.getDifficultyValue(t,10,25,50,100)*o);return{credits:n,reputation:a}}calculateTimeLimit(e,t,i){let s=this.getDifficultyValue(t,18e5,12e5,9e5,6e5),r=e.length*3e5,o=this.getDifficultyMultiplier(),n=o===.5?1.5:o===1.5?.75:1;return Math.floor((s+r)*i*n)}getDifficultyValue(e,t,i,s,r){switch(e){case"easy":return t;case"medium":return i;case"hard":return s;case"expert":return r}}getDifficultyAccess(e){switch(e){case"easy":return"user";case"medium":return"admin";case"hard":return"root";case"expert":return"root"}}randomDifficulty(e,t){let i=["easy","medium","hard","expert"],s=i.indexOf(e),r=i.indexOf(t),o=Math.floor(Math.random()*(r-s+1))+s;return i[o]}randomElement(e){return e[Math.floor(Math.random()*e.length)]}saveMissions(){if(!this.sandboxMode)try{localStorage.setItem("webos_missions",JSON.stringify(this.missions()))}catch(e){console.error("Failed to save missions:",e)}}loadMissions(){try{let e=localStorage.getItem("webos_missions");if(e){let t=JSON.parse(e);this.missions.set(t),this.nextMissionId=Math.max(...t.map(i=>parseInt(i.id.split("_")[1])||0))+1}}catch(e){console.error("Failed to load missions:",e)}}getReputation(e){return this.playerReputations().find(t=>t.factionId===e)}getAllReputations(){return this.playerReputations()}getReputationLevel(e){let t=this.getReputation(e);if(!t)return"Neutral";for(let i=this.REPUTATION_THRESHOLDS.length-1;i>=0;i--){let s=this.REPUTATION_THRESHOLDS[i];if(t.reputation>=s.minReputation)return s.level}return"Neutral"}getUnlockedFeatures(e){let t=this.getReputation(e);if(!t)return[];let i=[];for(let s of this.REPUTATION_THRESHOLDS)t.reputation>=s.minReputation&&s.unlocks&&i.push(...s.unlocks);return i}getFaction(e){return this.FACTIONS.find(t=>t.id===e)}getAllFactions(){return this.FACTIONS}getFactionRelationship(e,t){let i=this.getFaction(e);return i?i.relationships.get(t)||"neutral":"neutral"}updateReputation(e,t,i){let s=this.getReputation(e);if(!s)return;let r=this.getReputationLevel(e);s.reputation+=t,s.level=this.getReputationLevel(e),this.applyRelationshipEffects(e,t,i),this.playerReputations.update(o=>o.map(n=>n.factionId===e?s:n)),this.saveReputations()}applyRelationshipEffects(e,t,i){let s=this.getFaction(e);if(s)for(let[r,o]of s.relationships.entries()){let n=0;switch(o){case"ally":n=.25;break;case"hostile":n=-.5;break;case"neutral":n=0;break}if(n!==0){let a=this.getReputation(r);if(a){let l=Math.floor(t*n);a.reputation+=l,a.level=this.getReputationLevel(r),this.playerReputations.update(v=>v.map(y=>y.factionId===r?a:y))}}}}initializeReputations(){if(this.playerReputations().length===0){let t=this.FACTIONS.map(i=>({factionId:i.id,reputation:0,level:"Neutral"}));this.playerReputations.set(t),this.saveReputations()}}saveReputations(){try{localStorage.setItem("webos_reputations",JSON.stringify(this.playerReputations()))}catch(e){console.error("Failed to save reputations:",e)}}loadReputations(){try{let e=localStorage.getItem("webos_reputations");if(e){let t=JSON.parse(e);this.playerReputations.set(t)}}catch(e){console.error("Failed to load reputations:",e)}}distributeReward(e){this.economyService.addCredits(e.credits,"mission_reward",`Mission reward: ${e.credits} credits`,{reputation:e.reputation}),this.notificationService.success("Mission Completed!",`Earned ${e.credits} credits${e.reputation?` and ${e.reputation} reputation`:""}`)}updateStats(e){let t=this.playerStats();this.playerStats.set(p(m({},t),{missionsCompleted:t.missionsCompleted+(e.missionsCompleted||0),missionsFailed:t.missionsFailed+(e.missionsFailed||0),totalMissionsAttempted:t.totalMissionsAttempted+(e.totalMissionsAttempted||0)})),this.savePlayerStats()}addToHistory(e){this.missionHistory.update(t=>[e,...t]),this.saveMissionHistory()}savePlayerStats(){try{localStorage.setItem("webos_player_stats",JSON.stringify(this.playerStats()))}catch(e){console.error("Failed to save player stats:",e)}}loadPlayerStats(){try{let e=localStorage.getItem("webos_player_stats");if(e){let t=JSON.parse(e),i={missionsCompleted:t.missionsCompleted||0,missionsFailed:t.missionsFailed||0,totalMissionsAttempted:t.totalMissionsAttempted||0};this.playerStats.set(i),("credits"in t||"totalCreditsEarned"in t)&&this.savePlayerStats()}}catch(e){console.error("Failed to load player stats:",e)}}saveMissionHistory(){try{let e=this.missionHistory().slice(0,100);localStorage.setItem("webos_mission_history",JSON.stringify(e))}catch(e){console.error("Failed to save mission history:",e)}}loadMissionHistory(){try{let e=localStorage.getItem("webos_mission_history");if(e){let t=JSON.parse(e);this.missionHistory.set(t)}}catch(e){console.error("Failed to load mission history:",e)}}saveGameDifficulty(){try{localStorage.setItem("webos_game_difficulty",this.gameDifficulty())}catch(e){console.error("Failed to save game difficulty:",e)}}loadGameDifficulty(){try{let e=localStorage.getItem("webos_game_difficulty");e&&(e==="easy"||e==="normal"||e==="hard")&&this.gameDifficulty.set(e)}catch(e){console.error("Failed to load game difficulty:",e)}}setSandboxMode(e){this.sandboxMode=e}createSandboxSnapshot(){return[...this.missions()]}restoreSandboxSnapshot(e){this.missions.set([...e]),this.saveMissions()}static \u0275fac=function(t){return new(t||d)};static \u0275prov=h({token:d,factory:d.\u0275fac,providedIn:"root"})};export{A as a,L as b,E as c,O as d,w as e,M as f,T as g,x as h,P as i};
