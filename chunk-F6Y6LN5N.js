import{Db as m,Eb as b,Fb as A,Ja as N,Ka as d,Ra as S,Ta as F,Ub as x,Vb as O,Wa as y,Wb as r,Xa as j,_b as z,aa as I,bb as B,c as L,da as M,db as _,ea as v,eb as T,fb as k,hc as C,ia as V,ka as g,la as u,ob as a,pb as s,qb as K,sb as P,tb as q,ua as E,ub as w,vb as h,wb as f,za as H}from"./chunk-IQ6ZNRPZ.js";var R=class n{text=r.required();position=r("top");static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-tooltip"]],inputs:{text:[1,"text"],position:[1,"position"]},decls:4,vars:2,consts:[[1,"tooltip"],[1,"tooltip-content"],[1,"tooltip-arrow"]],template:function(e,o){e&1&&(a(0,"div",0)(1,"div",1),m(2),s(),K(3,"div",2),s()),e&2&&(_("data-position",o.position()),d(2),b(o.text()))},dependencies:[C],styles:[".tooltip[_ngcontent-%COMP%]{position:fixed;z-index:10000;pointer-events:none;animation:_ngcontent-%COMP%_tooltipFadeIn .15s ease-out;max-width:250px}.tooltip-content[_ngcontent-%COMP%]{background:#000000e6;color:#fff;padding:6px 10px;border-radius:4px;font-size:12px;line-height:1.4;white-space:nowrap;box-shadow:0 2px 8px #0000004d;border:1px solid rgba(255,255,255,.1)}.tooltip-arrow[_ngcontent-%COMP%]{position:absolute;width:0;height:0;border-style:solid}.tooltip[data-position=top][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{bottom:-5px;left:50%;transform:translate(-50%);border-width:5px 5px 0 5px;border-color:rgba(0,0,0,.9) transparent transparent transparent}.tooltip[data-position=bottom][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{top:-5px;left:50%;transform:translate(-50%);border-width:0 5px 5px 5px;border-color:transparent transparent rgba(0,0,0,.9) transparent}.tooltip[data-position=left][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{right:-5px;top:50%;transform:translateY(-50%);border-width:5px 0 5px 5px;border-color:transparent transparent transparent rgba(0,0,0,.9)}.tooltip[data-position=right][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{left:-5px;top:50%;transform:translateY(-50%);border-width:5px 5px 5px 0;border-color:transparent rgba(0,0,0,.9) transparent transparent}@keyframes _ngcontent-%COMP%_tooltipFadeIn{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}"]})},Y=class n{appTooltip=r.required();tooltipPosition=r("top");tooltipDelay=r(500);elementRef=v(H);renderer=v(S);viewContainerRef=v(F);tooltipRef;showTimeout;hideTimeout;constructor(){x(()=>{let t=this.appTooltip();this.tooltipRef&&this.tooltipRef.setInput("text",t)}),x(()=>{let t=this.tooltipPosition();this.tooltipRef&&this.tooltipRef.setInput("position",t)})}onMouseEnter(){this.clearTimeouts(),this.showTimeout=window.setTimeout(()=>{this.show()},this.tooltipDelay())}onMouseLeave(){this.clearTimeouts(),this.hideTimeout=window.setTimeout(()=>{this.hide()},100)}onClick(){this.clearTimeouts(),this.hide()}show(){if(this.tooltipRef)return;this.tooltipRef=this.viewContainerRef.createComponent(R),this.tooltipRef.setInput("text",this.appTooltip()),this.tooltipRef.setInput("position",this.tooltipPosition()),this.tooltipRef.changeDetectorRef.detectChanges();let t=this.tooltipRef.location.nativeElement;this.renderer.appendChild(document.body,t),this.positionTooltip(t)}hide(){this.tooltipRef&&(this.tooltipRef.destroy(),this.tooltipRef=void 0)}positionTooltip(t){let e=this.elementRef.nativeElement.getBoundingClientRect(),o=t.getBoundingClientRect(),i=this.tooltipPosition(),p=8,l=0,c=0;switch(i){case"top":l=e.top-o.height-p,c=e.left+(e.width-o.width)/2;break;case"bottom":l=e.bottom+p,c=e.left+(e.width-o.width)/2;break;case"left":l=e.top+(e.height-o.height)/2,c=e.left-o.width-p;break;case"right":l=e.top+(e.height-o.height)/2,c=e.right+p;break}l=Math.max(4,Math.min(l,window.innerHeight-o.height-4)),c=Math.max(4,Math.min(c,window.innerWidth-o.width-4)),this.renderer.setStyle(t,"top",`${l}px`),this.renderer.setStyle(t,"left",`${c}px`)}clearTimeouts(){this.showTimeout&&(window.clearTimeout(this.showTimeout),this.showTimeout=void 0),this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=void 0)}ngOnDestroy(){this.clearTimeouts(),this.hide()}static \u0275fac=function(e){return new(e||n)};static \u0275dir=j({type:n,selectors:[["","appTooltip",""]],hostBindings:function(e,o){e&1&&w("mouseenter",function(){return o.onMouseEnter()})("mouseleave",function(){return o.onMouseLeave()})("click",function(){return o.onClick()})},inputs:{appTooltip:[1,"appTooltip"],tooltipPosition:[1,"tooltipPosition"],tooltipDelay:[1,"tooltipDelay"]}})};function G(n,t){if(n&1){let e=P();a(0,"label",7)(1,"input",11),h("change",function(){g(e);let i=f(2);return u(i.toggleDontAskAgain())}),s(),a(2,"span"),m(3,"Don't ask again"),s()()}if(n&2){let e=f(2);d(),q("checked",e.dontAskAgain())}}function Q(n,t){if(n&1){let e=P();a(0,"div",1),h("click",function(){g(e);let i=f();return u(i.onCancel())}),a(1,"div",2),h("click",function(i){return g(e),u(i.stopPropagation())}),a(2,"div",3)(3,"h2",4),m(4),s()(),a(5,"div",5)(6,"p",6),m(7),s(),T(8,G,4,1,"label",7),s(),a(9,"div",8)(10,"button",9),h("click",function(){g(e);let i=f();return u(i.onCancel())}),m(11),s(),a(12,"button",10),h("click",function(){g(e);let i=f();return u(i.onConfirm())}),m(13),s()()()()}if(n&2){let e=f();d(),_("aria-labelledby","dialog-title"),d(3),b(e.title()),d(3),b(e.message()),d(),k(e.showDontAskAgain()?8:-1),d(3),A(" ",e.cancelLabel()," "),d(2),A(" ",e.confirmLabel()," ")}}var D=class n{title=r.required();message=r.required();confirmLabel=r("Confirm");cancelLabel=r("Cancel");showDontAskAgain=r(!1);confirm=O();cancel=O();isVisible=E(!0);dontAskAgain=E(!1);focusableElements=[];previouslyFocusedElement=null;constructor(){x(()=>{this.isVisible()?(this.previouslyFocusedElement=document.activeElement,this.trapFocus()):this.restoreFocus()})}onKeyDown(t){if(this.isVisible()){if(t.key==="Escape"){this.onCancel();return}t.key==="Tab"&&this.handleTabKey(t)}}handleTabKey(t){if(this.focusableElements.length===0)return;let e=this.focusableElements[0],o=this.focusableElements[this.focusableElements.length-1];t.shiftKey?document.activeElement===e&&(t.preventDefault(),o.focus()):document.activeElement===o&&(t.preventDefault(),e.focus())}onConfirm(){this.confirm.emit(this.dontAskAgain()),this.isVisible.set(!1)}onCancel(){this.cancel.emit(),this.isVisible.set(!1)}toggleDontAskAgain(){this.dontAskAgain.update(t=>!t)}trapFocus(){setTimeout(()=>{let t=document.querySelector(".dialog");if(t&&(this.focusableElements=Array.from(t.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')),this.focusableElements.length>0)){let e=t.querySelector(".dialog-button-confirm");e?e.focus():this.focusableElements[0].focus()}},0)}restoreFocus(){this.previouslyFocusedElement&&(this.previouslyFocusedElement.focus(),this.previouslyFocusedElement=null)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-dialog"]],hostBindings:function(e,o){e&1&&w("keydown",function(p){return o.onKeyDown(p)},N)},inputs:{title:[1,"title"],message:[1,"message"],confirmLabel:[1,"confirmLabel"],cancelLabel:[1,"cancelLabel"],showDontAskAgain:[1,"showDontAskAgain"]},outputs:{confirm:"confirm",cancel:"cancel"},decls:1,vars:1,consts:[[1,"dialog-overlay"],[1,"dialog-overlay",3,"click"],["role","dialog","aria-modal","true",1,"dialog",3,"click"],[1,"dialog-header"],["id","dialog-title",1,"dialog-title"],[1,"dialog-body"],[1,"dialog-message"],[1,"dialog-checkbox"],[1,"dialog-footer"],["type","button","aria-label","Cancel",1,"dialog-button","dialog-button-cancel",3,"click"],["type","button","aria-label","Confirm action",1,"dialog-button","dialog-button-confirm",3,"click"],["type","checkbox","aria-label","Don't ask again",3,"change","checked"]],template:function(e,o){e&1&&T(0,Q,14,6,"div",0),e&2&&k(o.isVisible()?0:-1)},dependencies:[C],styles:[".dialog-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:10000;animation:_ngcontent-%COMP%_fadeIn .2s ease-out}.dialog[_ngcontent-%COMP%]{background:var(--window-bg, #2a2a2a);border:1px solid var(--window-border, #444);border-radius:8px;box-shadow:0 8px 32px #0006,0 16px 64px #0000004d;min-width:400px;max-width:600px;animation:_ngcontent-%COMP%_slideIn .2s ease-out}.dialog-header[_ngcontent-%COMP%]{padding:16px 20px;border-bottom:1px solid var(--window-border, #444)}.dialog-title[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:var(--text-color, #e0e0e0)}.dialog-body[_ngcontent-%COMP%]{padding:20px}.dialog-message[_ngcontent-%COMP%]{margin:0 0 16px;color:var(--text-color, #e0e0e0);line-height:1.5}.dialog-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;-webkit-user-select:none;user-select:none}.dialog-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{cursor:pointer}.dialog-checkbox[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--text-color, #e0e0e0);font-size:14px}.dialog-footer[_ngcontent-%COMP%]{padding:16px 20px;border-top:1px solid var(--window-border, #444);display:flex;justify-content:flex-end;gap:12px}.dialog-button[_ngcontent-%COMP%]{padding:8px 20px;border-radius:4px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;border:1px solid transparent;min-width:80px}.dialog-button[_ngcontent-%COMP%]:focus{outline:2px solid var(--accent-color, #00ff00);outline-offset:2px}.dialog-button[_ngcontent-%COMP%]:hover{filter:brightness(1.1)}.dialog-button[_ngcontent-%COMP%]:active{transform:scale(.98)}.dialog-button-cancel[_ngcontent-%COMP%]{background:transparent;border-color:var(--window-border, #444);color:var(--text-color, #e0e0e0)}.dialog-button-confirm[_ngcontent-%COMP%]{background:var(--accent-color, #00ff00);color:var(--bg-color, #000)}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translateY(-20px);opacity:0}to{transform:translateY(0);opacity:1}}"]})};var $=class n{constructor(t,e){this.appRef=t;this.injector=e;this.loadPreferences()}preferences=new Map;confirm(t){return L(this,null,function*(){return t.preferenceKey&&this.preferences.get(t.preferenceKey)?{confirmed:!0,dontAskAgain:!0}:new Promise(e=>{let o=z(D,{environmentInjector:this.injector});o.setInput("title",t.title),o.setInput("message",t.message),o.setInput("confirmLabel",t.confirmText||t.confirmLabel||"Confirm"),o.setInput("cancelLabel",t.cancelText||t.cancelLabel||"Cancel"),o.setInput("showDontAskAgain",t.showDontAskAgain||!1);let i=o.instance.confirm.subscribe(c=>{t.preferenceKey&&c&&this.savePreference(t.preferenceKey,!0),l(),e({confirmed:!0,dontAskAgain:c})}),p=o.instance.cancel.subscribe(()=>{l(),e({confirmed:!1,dontAskAgain:!1})}),l=()=>{i.unsubscribe(),p.unsubscribe(),this.appRef.detachView(o.hostView),o.destroy()};this.appRef.attachView(o.hostView),document.body.appendChild(o.location.nativeElement)})})}clearPreference(t){this.preferences.delete(t),this.savePreferences()}clearAllPreferences(){this.preferences.clear(),this.savePreferences()}savePreference(t,e){this.preferences.set(t,e),this.savePreferences()}savePreferences(){let t=Array.from(this.preferences.entries());localStorage.setItem("dialog-preferences",JSON.stringify(t))}loadPreferences(){let t=localStorage.getItem("dialog-preferences");if(t)try{let e=JSON.parse(t);this.preferences.clear(),e.forEach(([o,i])=>this.preferences.set(o,i))}catch(e){console.error("Failed to load dialog preferences:",e)}}static \u0275fac=function(e){return new(e||n)(M(B),M(V))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};export{Y as a,$ as b};
